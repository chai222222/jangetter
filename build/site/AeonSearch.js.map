{"version":3,"sources":["../../src/site/AeonSearch.js"],"names":["AEON_CONSTANTS","zip1","zip2","searchConfig","prefix","top","searchPageSelectors","productsLink","nextLink","searchText","searchButton","productPageSelectors","jan","title","productPageImageSelectors","picture","replacer","REPLACERS","trim","toHarfWidthSpace","pattern","value","category","toOneSpace","AeonSearch","JanSearchBase","init","needInputShop","existsAll","page","type","click","waitFor","waitLoaded","fairDialogClose","getSrcConfig"],"mappings":";;;;;;;AAAA;;AACA;;AACA;;;;AAEA,MAAMA,cAAc,GAAG;AACrBC,EAAAA,IAAI,EAAE,KADe;AAErBC,EAAAA,IAAI,EAAE,MAFe;AAGrBC,EAAAA,YAAY,EAAE;AACZC,IAAAA,MAAM,EAAE,MADI;AAEZC,IAAAA,GAAG,EAAE,8BAFO;AAGZC,IAAAA,mBAAmB,EAAE;AACnBC,MAAAA,YAAY,EAAE,8BADK;AAEnBC,MAAAA,QAAQ,EAAE,qFAFS;AAGnBC,MAAAA,UAAU,EAAE,SAHO;AAInBC,MAAAA,YAAY,EAAE;AAJK,KAHT;AASZC,IAAAA,oBAAoB,EAAE;AACpBC,MAAAA,GAAG,EAAE,YADe;AAEpB;AACAC,MAAAA,KAAK,EAAE;AAHa,KATV;AAcZC,IAAAA,yBAAyB,EAAE;AACzBC,MAAAA,OAAO,EAAE;AADgB,KAdf;AAiBZC,IAAAA,QAAQ,EAAE;AACRH,MAAAA,KAAK,EAAE,CACLI,oBAAUC,IADL,EAELD,oBAAUE,gBAFL,EAGLF,oBAAUE,gBAHL,CADC;AAMRP,MAAAA,GAAG,EAAE,CAAC;AACJQ,QAAAA,OAAO,EAAE,KADL;AAEJC,QAAAA,KAAK,EAAE;AAFH,OAAD,CANG;AAURC,MAAAA,QAAQ,EAAE,CACRL,oBAAUM,UADF,EAERN,oBAAUC,IAFF;AAVF;AAjBE;AAHO,CAAvB;;AAsCe,MAAMM,UAAN,SAAyBC,sBAAzB,CAAuC;AAEpD;AACF;AACA;AACY,QAAJC,IAAI,GAAG;AACX,UAAMC,aAAa,GAAG,MAAM,KAAKC,SAAL,CAAe,OAAf,EAAwB,OAAxB,EAAiC,gBAAjC,CAA5B;;AACA,QAAID,aAAJ,EAAmB;AACjB,YAAM,KAAKE,IAAL,CAAUC,IAAV,CAAe,OAAf,EAAwB9B,cAAc,CAACC,IAAvC,CAAN;AACA,YAAM,KAAK4B,IAAL,CAAUC,IAAV,CAAe,OAAf,EAAwB9B,cAAc,CAACE,IAAvC,CAAN;AACA,WAAK2B,IAAL,CAAUE,KAAV,CAAgB,gBAAhB;AACA,YAAM,KAAKF,IAAL,CAAUG,OAAV,CAAkB,IAAlB,CAAN;AACA,WAAKH,IAAL,CAAUE,KAAV,CAAgB,mDAAhB,EALiB,CAMjB;;AACA,YAAM,KAAKE,UAAL,EAAN;AACD;;AACD,UAAMC,eAAe,GAAG,MAAM,KAAKN,SAAL,CAAe,gBAAf,CAA9B;;AACA,QAAIM,eAAJ,EAAqB;AACnB,WAAKL,IAAL,CAAUE,KAAV,CAAgB,gBAAhB;AACA,YAAM,KAAKE,UAAL,EAAN;AACD,KAfU,CAgBX;AACA;AACA;AACA;;AACD;;AAEDE,EAAAA,YAAY,GAAG;AACb,WAAOnC,cAAc,CAACG,YAAtB;AACD;;AA7BmD","sourcesContent":["import { map, mapSeries } from 'p-iteration';\nimport JanSearchBase from './JanSearchBase';\nimport { REPLACERS } from '../util/Replacer';\n\nconst AEON_CONSTANTS = {\n  zip1: '214',\n  zip2: '0038',\n  searchConfig: {\n    prefix: 'Aeon',\n    top: 'https://www.aeonnetshop.com/',\n    searchPageSelectors: {\n      productsLink: 'div.search.results ol li > a',\n      nextLink: '//div[@class=\"column main\"]/div[last()]//a[@tabindex=0]/span[contains(text(), \"次\")]',\n      searchText: '#search',\n      searchButton: '#cx-search-button',\n    },\n    productPageSelectors: {\n      jan: 'p.jan-code',\n      // category: '#recently_category ul',\n      title: 'div.product-info-main H2.section-title-text',\n    },\n    productPageImageSelectors: {\n      picture: 'img.fotorama__img',\n    },\n    replacer: {\n      title: [\n        REPLACERS.trim,\n        REPLACERS.toHarfWidthSpace,\n        REPLACERS.toHarfWidthSpace,\n      ],\n      jan: [{\n        pattern: /\\D/g,\n        value: '',\n      }],\n      category: [\n        REPLACERS.toOneSpace,\n        REPLACERS.trim,\n      ],\n    },\n  },\n};\n\nexport default class AeonSearch extends JanSearchBase {\n\n  /**\n   * 検索可能画面になるまで遷移する。\n   */\n  async init() {\n    const needInputShop = await this.existsAll('#zip1', '#zip2', '#shop_search_1');\n    if (needInputShop) {\n      await this.page.type('#zip1', AEON_CONSTANTS.zip1);\n      await this.page.type('#zip2', AEON_CONSTANTS.zip2) ;\n      this.page.click('#shop_search_1')\n      await this.page.waitFor(1000);\n      this.page.click('#shop_search_result_list_area .result-list-area a');\n      // await this.page.waitFor(10000);\n      await this.waitLoaded();\n    }\n    const fairDialogClose = await this.existsAll('a.pc2015-close');\n    if (fairDialogClose) {\n      this.page.click('a.pc2015-close');\n      await this.waitLoaded();\n    }\n    // const banner = await this.existsAll('#pc2015-popup-ad-banner a.pc2015-close');\n    // if (banner) {\n    //   await this.page.click('#pc2015-popup-ad-banner a.pc2015-close');\n    // }\n  }\n\n  getSrcConfig() {\n    return AEON_CONSTANTS.searchConfig;\n  }\n}\n"],"file":"AeonSearch.js"}