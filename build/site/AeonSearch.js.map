{"version":3,"sources":["../../src/site/AeonSearch.js"],"names":["AEON_CONSTANTS","zip1","zip2","searchConfig","prefix","top","searchPageSelectors","productsLink","nextLink","searchText","searchButton","productPageSelectors","jan","title","productPageImageSelectors","picture","replacer","REPLACERS","trim","toHarfWidthSpace","pattern","value","category","toOneSpace","AeonSearch","existsAll","needInputShop","page","type","click","waitFor","waitLoaded","fairDialogClose","JanSearchBase"],"mappings":";;;;;;;;AAAA;;AACA;;;;AACA;;;;;;;;;;;;AAEA,IAAMA,iBAAiB;AACrBC,QAAM,KADe;AAErBC,QAAM,MAFe;AAGrBC,gBAAc;AACZC,YAAQ,MADI;AAEZC,SAAK,8BAFO;AAGZC,yBAAqB;AACnBC,oBAAc,8BADK;AAEnBC,gBAAU,qFAFS;AAGnBC,kBAAY,SAHO;AAInBC,oBAAc;AAJK,KAHT;AASZC,0BAAsB;AACpBC,WAAK,YADe;AAEpB;AACAC,aAAO;AAHa,KATV;AAcZC,+BAA2B;AACzBC,eAAS;AADgB,KAdf;AAiBZC,cAAU;AACRH,aAAO,CACLI,oBAAUC,IADL,EAELD,oBAAUE,gBAFL,EAGLF,oBAAUE,gBAHL,CADC;AAMRP,WAAK,CAAC;AACJQ,iBAAS,KADL;AAEJC,eAAO;AAFH,OAAD,CANG;AAURC,gBAAU,CACRL,oBAAUM,UADF,EAERN,oBAAUC,IAFF;AAVF;AAjBE;AAHO,CAAvB;;IAsCqBM,U;;;;;;;;;;;;;AAEnB;;;;;;;;;;;uBAI8B,KAAKC,SAAL,CAAe,OAAf,EAAwB,OAAxB,EAAiC,gBAAjC,C;;;AAAtBC,6B;;qBACFA,a;;;;;;uBACI,KAAKC,IAAL,CAAUC,IAAV,CAAe,OAAf,EAAwB5B,eAAeC,IAAvC,C;;;;uBACA,KAAK0B,IAAL,CAAUC,IAAV,CAAe,OAAf,EAAwB5B,eAAeE,IAAvC,C;;;AACN,qBAAKyB,IAAL,CAAUE,KAAV,CAAgB,gBAAhB;;uBACM,KAAKF,IAAL,CAAUG,OAAV,CAAkB,IAAlB,C;;;AACN,qBAAKH,IAAL,CAAUE,KAAV,CAAgB,mDAAhB;AACA;;uBACM,KAAKE,UAAL,E;;;;uBAEsB,KAAKN,SAAL,CAAe,gBAAf,C;;;AAAxBO,+B;;qBACFA,e;;;;;AACF,qBAAKL,IAAL,CAAUE,KAAV,CAAgB,gBAAhB;;uBACM,KAAKE,UAAL,E;;;;;;;;;;;;;;;;;;mCAQK;AACb,aAAO/B,eAAeG,YAAtB;AACD;;;;EA7BqC8B,uB;;kBAAnBT,U","file":"AeonSearch.js","sourcesContent":["import { map, mapSeries } from 'p-iteration';\nimport JanSearchBase from './JanSearchBase';\nimport { REPLACERS } from '../util/Replacer';\n\nconst AEON_CONSTANTS = {\n  zip1: '214',\n  zip2: '0038',\n  searchConfig: {\n    prefix: 'Aeon',\n    top: 'https://www.aeonnetshop.com/',\n    searchPageSelectors: {\n      productsLink: 'div.search.results ol li > a',\n      nextLink: '//div[@class=\"column main\"]/div[last()]//a[@tabindex=0]/span[contains(text(), \"次\")]',\n      searchText: '#search',\n      searchButton: '#cx-search-button',\n    },\n    productPageSelectors: {\n      jan: 'p.jan-code',\n      // category: '#recently_category ul',\n      title: 'div.product-info-main H2.section-title-text',\n    },\n    productPageImageSelectors: {\n      picture: 'img.fotorama__img',\n    },\n    replacer: {\n      title: [\n        REPLACERS.trim,\n        REPLACERS.toHarfWidthSpace,\n        REPLACERS.toHarfWidthSpace,\n      ],\n      jan: [{\n        pattern: /\\D/g,\n        value: '',\n      }],\n      category: [\n        REPLACERS.toOneSpace,\n        REPLACERS.trim,\n      ],\n    },\n  },\n};\n\nexport default class AeonSearch extends JanSearchBase {\n\n  /**\n   * 検索可能画面になるまで遷移する。\n   */\n  async init() {\n    const needInputShop = await this.existsAll('#zip1', '#zip2', '#shop_search_1');\n    if (needInputShop) {\n      await this.page.type('#zip1', AEON_CONSTANTS.zip1);\n      await this.page.type('#zip2', AEON_CONSTANTS.zip2) ;\n      this.page.click('#shop_search_1')\n      await this.page.waitFor(1000);\n      this.page.click('#shop_search_result_list_area .result-list-area a');\n      // await this.page.waitFor(10000);\n      await this.waitLoaded();\n    }\n    const fairDialogClose = await this.existsAll('a.pc2015-close');\n    if (fairDialogClose) {\n      this.page.click('a.pc2015-close');\n      await this.waitLoaded();\n    }\n    // const banner = await this.existsAll('#pc2015-popup-ad-banner a.pc2015-close');\n    // if (banner) {\n    //   await this.page.click('#pc2015-popup-ad-banner a.pc2015-close');\n    // }\n  }\n\n  getSrcConfig() {\n    return AEON_CONSTANTS.searchConfig;\n  }\n}\n"]}