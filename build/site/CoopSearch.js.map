{"version":3,"sources":["../../src/site/CoopSearch.js"],"names":["COOP_CONSTANTS","searchConfig","prefix","top","searchPageSelectors","productsLink","nextLink","searchText","searchButton","productPageSelectors","jan","category","title","replacer","pattern","value","s","String","fromCharCode","charCodeAt","CoopSearch","key","console","log","getSrcConfig","page","$eval","item","baseURI","JanSearchBase"],"mappings":";;;;;;;;;;AAAA;;;;;;;;;;;;;;AAEA,IAAMA,iBAAiB;AACrBC,gBAAc;AACZC,YAAQ,MADI;AAEZC,SAAK,8BAFO;AAGZC,yBAAqB;AACnBC,oBAAc,yDADK;AAEnBC,gBAAU,oBAFS;AAGnBC,kBAAY,SAHO;AAInBC,oBAAc;AAJK,KAHT;AASZC,0BAAsB;AACpBC,WAAK,2CADe;AAEpBC,gBAAU,sCAFU;AAGpBC,aAAO;AAHa,KATV;AAcZC,cAAU;AACRD,aAAO,CAAC;AACNE,iBAAS,QADH;AAENC,eAAO;AAFD,OAAD,EAGJ;AACDD,iBAAS,cADR;AAEDC,eAAO,eAACC,CAAD,EAAO;AACZ,iBAAOC,OAAOC,YAAP,CAAoBF,EAAEG,UAAF,CAAa,CAAb,IAAkB,KAAtC,CAAP;AACD;AAJA,OAHI,EAQJ;AACDL,iBAAS,IADR;AAEDC,eAAO;AAFN,OARI,CADC;AAaRL,WAAK,CAAC;AACJI,iBAAS,mBADL;AAEJC,eAAO;AAFH,OAAD,EAGF;AACDD,iBAAS,YADR;AAEDC,eAAO;AAFN,OAHE,EAMF;AACDD,iBAAS,KADR;AAEDC,eAAO;AAFN,OANE,CAbG;AAuBRJ,gBAAU,CAAC;AACTG,iBAAS,MADA;AAETC,eAAO;AAFE,OAAD;AAvBF;AAdE;AADO,CAAvB;;IA8CqBK,U;;;;;;;;;;;mCAEJ;AACb,aAAOpB,eAAeC,YAAtB;AACD;;;;0FAEiBoB,G;;;;;sBACZA,QAAQ,K;;;;;AACVC,wBAAQC,GAAR,CAAY,KAAKC,YAAL,GAAoBf,oBAApB,CAAyCY,GAAzC,CAAZ;;uBACa,KAAKI,IAAL,CAAUC,KAAV,CAAgB,KAAKF,YAAL,GAAoBf,oBAApB,CAAyCY,GAAzC,CAAhB,EAA+D;AAAA,yBAAQM,KAAKC,OAAb;AAAA,iBAA/D,C;;;;;;qKAEYP,G;;;;;;;;;;;;;;;;;;;EAXSQ,uB;;kBAAnBT,U","file":"CoopSearch.js","sourcesContent":["import JanSearchBase from './JanSearchBase';\n\nconst COOP_CONSTANTS = {\n  searchConfig: {\n    prefix: 'Coop',\n    top: 'https://mdinfo.jccu.coop/bb/',\n    searchPageSelectors: {\n      productsLink: '#bubble_tooltip + table td:nth-child(2) a[href*=\"/bb/\"]',\n      nextLink: 'a.next:first-child',\n      searchText: '#shohin',\n      searchButton: '#shohin + input',\n    },\n    productPageSelectors: {\n      jan: '#basicInfo tbody > tr:nth-child(2) td img',\n      category: '#basicInfo tbody > tr:first-child td',\n      title: 'title',\n    },\n    replacer: {\n      title: [{\n        pattern: / < .*/g,\n        value: '',\n      }, {\n        pattern: /[Ａ-Ｚａ-ｚ０-９]/g,\n        value: (s) => {\n          return String.fromCharCode(s.charCodeAt(0) - 65248);\n        },\n      }, {\n        pattern: /^/g,\n        value: 'コープ ',\n      }],\n      jan: [{\n        pattern: /^.*shohindetail\\//,\n        value: '',\n      }, {\n        pattern: /\\/psspu.*$/,\n        value: '',\n      }, {\n        pattern: /\\D/g,\n        value: '',\n      }],\n      category: [{\n        pattern: /\\s+/g,\n        value: ' ',\n      }],\n    },\n  },\n};\n\nexport default class CoopSearch extends JanSearchBase {\n\n  getSrcConfig() {\n    return COOP_CONSTANTS.searchConfig;\n  }\n\n  async getPageText(key) {\n    if (key === 'jan') {\n      console.log(this.getSrcConfig().productPageSelectors[key]);\n      return await this.page.$eval(this.getSrcConfig().productPageSelectors[key], item => item.baseURI);\n    } else {\n      return super.getPageText(key);\n    }\n  }\n}\n"]}