{"version":3,"sources":["../../src/site/CoopSearch.js"],"names":["COOP_CONSTANTS","searchConfig","prefix","top","lastSupportedDate","searchPageSelectors","productsLink","nextLink","searchText","searchButton","productPageSelectors","jan","title","productPageImageSelectors","picture","replacer","REPLACERS","toHarfWidthAlnum","pattern","value","category","toOneSpace","trim","CoopSearch","JanSearchBase","getSrcConfig","getPageText","key","console","log","page","$eval","item","baseURI"],"mappings":";;;;;;;AAAA;;AACA;;;;AAEA,MAAMA,cAAc,GAAG;AACrBC,EAAAA,YAAY,EAAE;AACZC,IAAAA,MAAM,EAAE,MADI;AAEZC,IAAAA,GAAG,EAAE,8BAFO;AAGZC,IAAAA,iBAAiB,EAAE,sBAHP;AAIZC,IAAAA,mBAAmB,EAAE;AACnBC,MAAAA,YAAY,EAAE,yDADK;AAEnBC,MAAAA,QAAQ,EAAE,uBAFS;AAGnBC,MAAAA,UAAU,EAAE,SAHO;AAInBC,MAAAA,YAAY,EAAE;AAJK,KAJT;AAUZC,IAAAA,oBAAoB,EAAE;AACpBC,MAAAA,GAAG,EAAE,2CADe;AAEpB;AACAC,MAAAA,KAAK,EAAE;AAHa,KAVV;AAeZC,IAAAA,yBAAyB,EAAE;AACzBC,MAAAA,OAAO,EAAE;AADgB,KAff;AAkBZC,IAAAA,QAAQ,EAAE;AACRH,MAAAA,KAAK,EAAE,CACLI,oBAAUC,gBADL,EACuB;AAC1BC,QAAAA,OAAO,EAAE,QADiB;AAE1BC,QAAAA,KAAK,EAAE;AAFmB,OADvB,EAIF;AACDD,QAAAA,OAAO,EAAE,IADR;AAEDC,QAAAA,KAAK,EAAE;AAFN,OAJE,CADC;AAURR,MAAAA,GAAG,EAAE,CAAC;AACJO,QAAAA,OAAO,EAAE,6BADL;AAEJC,QAAAA,KAAK,EAAE;AAFH,OAAD,CAVG;AAcRC,MAAAA,QAAQ,EAAE,CACRJ,oBAAUK,UADF,EAERL,oBAAUM,IAFF;AAdF;AAlBE;AADO,CAAvB;;AAyCe,MAAMC,UAAN,SAAyBC,sBAAzB,CAAuC;AAEpDC,EAAAA,YAAY,GAAG;AACb,WAAOzB,cAAc,CAACC,YAAtB;AACD;;AAEgB,QAAXyB,WAAW,CAACC,GAAD,EAAM;AACrB,QAAIA,GAAG,KAAK,KAAZ,EAAmB;AACjBC,MAAAA,OAAO,CAACC,GAAR,CAAY,KAAKJ,YAAL,GAAoBf,oBAApB,CAAyCiB,GAAzC,CAAZ;AACA,aAAO,MAAM,KAAKG,IAAL,CAAUC,KAAV,CAAgB,KAAKN,YAAL,GAAoBf,oBAApB,CAAyCiB,GAAzC,CAAhB,EAA+DK,IAAI,IAAIA,IAAI,CAACC,OAA5E,CAAb;AACD,KAHD,MAGO;AACL,aAAO,MAAMP,WAAN,CAAkBC,GAAlB,CAAP;AACD;AACF;;AAbmD","sourcesContent":["import JanSearchBase from './JanSearchBase';\nimport { REPLACERS } from '../util/Replacer';\n\nconst COOP_CONSTANTS = {\n  searchConfig: {\n    prefix: 'Coop',\n    top: 'https://mdinfo.jccu.coop/bb/',\n    lastSupportedDate: '2022/05/24: 20:00:00',\n    searchPageSelectors: {\n      productsLink: '#bubble_tooltip + table td:nth-child(2) a[href*=\"/bb/\"]',\n      nextLink: 'td.detail span.next a',\n      searchText: '#shohin',\n      searchButton: '#shohin + input',\n    },\n    productPageSelectors: {\n      jan: '#basicInfo tbody > tr:nth-child(2) td img',\n      // category: '#basicInfo tbody > tr:first-child td',\n      title: 'title',\n    },\n    productPageImageSelectors: {\n      picture: '#basicInfo .itemPhoto img',\n    },\n    replacer: {\n      title: [\n        REPLACERS.toHarfWidthAlnum, {\n          pattern: / < .*/g,\n          value: '',\n        }, {\n          pattern: /^/g,\n          value: 'コープ ',\n        }\n      ],\n      jan: [{\n        pattern: /^.*shohindetail\\/(\\d+)\\/?.*/,\n        value: '$1',\n      }],\n      category: [\n        REPLACERS.toOneSpace,\n        REPLACERS.trim,\n      ],\n    },\n  },\n};\n\nexport default class CoopSearch extends JanSearchBase {\n\n  getSrcConfig() {\n    return COOP_CONSTANTS.searchConfig;\n  }\n\n  async getPageText(key) {\n    if (key === 'jan') {\n      console.log(this.getSrcConfig().productPageSelectors[key]);\n      return await this.page.$eval(this.getSrcConfig().productPageSelectors[key], item => item.baseURI);\n    } else {\n      return super.getPageText(key);\n    }\n  }\n}\n"],"file":"CoopSearch.js"}